<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <template>
        <article>
                # helloworld
                ##  我是h2
                我是 
                艺术大师 ihxaxa
                ### 我是h3
                #### 我是h4
                ##### 我是h5
                ###### 我是h6
                ############# 我是黄果树瀑布f
                我是小明
        </article>
    </template>
</body>
<script>
    class Markdown {
    constructor(props) {
        this.text = typeof props == 'string' ? props : props.el.innerHTML;
    }
    parseHtml() {
        let res = this.text.match(/(\S+\s*)/g);
        res = res.join('').split('\n');
        console.log(res);
        res.forEach((item,index) => {
            res[index]=item.trim() 
        });
        var fragment=document.createDocumentFragment();
        res.forEach(item=>{
            if(item.indexOf('#')>-1){
                var arr=item.split(/(\s+)/g)
                var length=arr[0].length>6?6:arr[0].length
                var el=document.createElement('h'+length)
                el.textContent=arr[2]
                fragment.appendChild(el)
            }
            else{
                var p=document.createElement('p')
                p.textContent=item
                fragment.appendChild(p)
            }
        })
        return fragment;
    }
}

let md = new Markdown({ el: document.querySelector('template').content.querySelector('article') });
let res = md.parseHtml();

//     class Markdown{
//     constructor(text){
//         this.text = text;
//     }

//     parse(){
//         return this.parseHtml(this.text);
//     }

//     parseHtml(text){
//         let reg = /(#+)\s+([^\n]+)/;
//         let flag = false;
//         let res = text.replace(reg,function(item){
//             console.log(item);
//             flag = true;
//             let n = RegExp.$1.length > 6 ? 6 : RegExp.$1.length;
//             let textConent = RegExp.$2;
//             return `<h${n}>${textConent}</h${n}>`;
//         })
//         if(flag){
//             res = this.parseHtml(res);
//         }
//         return res;
//     }
// }

// var el = document.querySelector('article');
// let md = new Markdown(el.textContent);
// let res = md.parse();
// el.innerHTML = res;
</script>



<!-- <script>
    class Markdown {
        constructor(props) {
            this.el = props.el
        }
        parseHtml() {
            var res = this.el.match(/(#+\s*)|\S+|\n/g)
            var labelarr = []
            var textarr = []
            res.forEach(function (item, index) {
                if (index % 3 == 1) labelarr.push(item);
                if (index % 3 == 2) textarr.push(item);
            })
            var labelarr = labelarr.map(val => val.trim()).filter(val => val !== '')
            for (let i = 0; i < labelarr.length; i++) {
                var element = document.createElement(`h` + labelarr[i].length)
                element.innerText = textarr[i]
                document.querySelector('.textarticle').appendChild(element);
            }
        }
    }
    let md = new Markdown({
        el: document.querySelector('template').content.querySelector('article').innerText
    });
    let res = md.parseHtml()

    //作业三：
    var text = '{{ username }}';
    text.replace(/\{\{\s*(\S+)\s*\}\}/,'$1')
    console.log(text);
    // username是一个变量  用正则匹配到 username
    // 方法一：
    // '{{ username }}'.replace(/\{\{\s*(\S+)\s*\}\}/,'$1')
    // 方法二：
    // var a = text.match(/(?<=\{\{\s*)\S+(?=\s*\}\})/);
    // 方法三：
    // var a = /(?<=\{\{\s*)\S+(?=\s*\}\})/.exec(text)[0];


    // 断言：   断：判断   言：说； 我判断
    //先行断言  
    // hello(?=world)   'helloworld' 可以匹配hello，但不包含world;
    // hello(?=world)   'helloabc' 什么也匹配不到;
    // 我判断，hello后跟的是world 如果不是，那匹配不成功；


    //后行断方：
    //(?<=hello)world  
    // 我判断 world前面是不是hello ，如果是,那我返回world;
    // //作业二：
    // var deptData = [
    //     {
    //         deptName:'某某公司',
    //         type:2
    //     },
    //     {
    //         deptName:'子公司',
    //         type:4
    //     },
    //     {
    //         deptName:'子子部门',
    //         type:5
    //     }
    // ]
    // var a = '2->4，5'; 
    // var res = format() // 某某公司->子公司，子子部门
    // function format() {
    //     return a.replace(/\d+/g, function (item) {
    //         return deptData.filter(data => {
    //             return data.type == item;
    //         })[0].deptName;
    //     })
    // }
</script> -->

</html>